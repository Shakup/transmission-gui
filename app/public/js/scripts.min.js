!function(a){function b(a,b){for(var c,d=/{{([^}}]+)?}}/g;c=d.exec(a);)a=a.replace(c[0],b[c[1]]||"");return a}function c(a,b,c){if(void 0==c&&(c=!0),void 0==b&&(b=2),0===a||isNaN(a))return"0"+(c?"B":"");var d=["B","Kb","Mb","Gb","Tb","Pb"],e=Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,e)).toFixed(b)+(c?d[e]:"")}function d(a){var b=Math.ceil(a/1e6);if(0===a)return"complete";var c=seconds=minutes=jours=days=0;return c=a/1e6,seconds=Math.floor(c%60),c/=60,minutes=Math.floor(c%60),c/=60,hours=Math.floor(c%24),c/=24,days=Math.floor(c),_days=parseInt(b/86400),b%=86400,_hours=parseInt(b/3600),b%=3600,_minutes=parseInt(b/60),_seconds=parseInt(b%60),console.log(_days+"-"+_hours+"-"+_minutes+"-"+_seconds),days?days+"d":hours?hours+"h":minutes?minutes+"m":seconds+"s"}function e(){a("#btn-toggle-menu").click(function(){a("#menu-wrapper").show(),setTimeout(function(){a("#menu-wrapper").addClass("active")},10)}),a("#menu-wrapper").click(function(){a("#menu-wrapper").removeClass("active"),setTimeout(function(){a("#menu-wrapper").hide()},350)}),a(".primary-menu").click(function(a){a.stopPropagation()}),a(document).delegate(".torrent-ctrl, .torrent-ctrl i","click",g),a(document).delegate(".torrent-delete, .torrent-delete i","click",h),f(a("#cover").data("cover"));for(var b=50;b>0;b--)n.download.push(0),n.upload.push(0),n.labels.push("");a.get("/api/torrent/all").success(function(b){a("#torrents-loader").remove(),b.forEach(m),l(),i(),j()})}function f(b){var c="/assets/img/covers/"+b+".jpg",d=parseInt(a("#cover").data("covers"));img=new Image,d&&(img.onload=function(){a("#cover").css("opacity",0),setTimeout(function(){a("#cover").css({backgroundImage:'url("'+c+'")',opacity:1}),d>1&&(b++,b>parseInt(a("#cover").data("covers"))&&(b=1),setTimeout(function(){f(b)},6e4))},500)},img.src=c)}function g(){"i"==this.tagName.toLowerCase()?a(this).parent().toggleClass("active"):a(this).toggleClass("active")}function h(){}function i(){a.get("/api/torrent/session").complete(function(){setTimeout(function(){i()},1e4)}).success(function(b){a("#free-space").html(c(b["download-dir-free-space"]))})}function j(){a.get("/api/torrent/all").success(function(a){a.forEach(k),setTimeout(function(){j()},1e3)})}function k(b){var e=a("#torrent-"+b.id);e.hasElements()&&(e.find(".torrent-progress div").css("width",100*b.percentDone+"%").attr("class",b.error>0?"error":1===b.percentDone?"complete":""),e.find(".torrent-meta-download span").html(c(b.downloadedEver)),e.find(".torrent-meta-upload span").html(c(b.uploadedEver)),e.find(".torrent-meta-ratio span").html(b.uploadRatio.toFixed(2)),e.find(".torrent-meta-peers span").html(b.peersConnected+"/"+b["peer-limit"]),e.find(".torrent-meta-time span").html(b.error>0?"unknown":d(b.leftUntilDone)))}function l(){a.get("/api/torrent/stats").complete(function(){setTimeout(function(){l()},2500)}).success(function(b){var d,e;if(d=b.uploadSpeed,e=b.downloadSpeed,n.upload.shift(),n.download.shift(),n.upload.push((d/1048576).toFixed(1)),n.download.push((e/1048576).toFixed(1)),a("#download-speed").html(c(e,1)+"<em>/s</em>"),a("#upload-speed").html(c(d,1)+"<em>/s</em>"),o){var f;for(f=0;f<n.download.length;f++)o.datasets[0].points[f].value=n.download[f],bandwidthUploadChart.datasets[0].points[f].value=n.upload[f];o.update(),bandwidthUploadChart.update()}else{var g={labels:n.labels,datasets:[{label:"Download",fillColor:"rgba(41,128,185,.9)",data:n.download}]},h={labels:n.labels,datasets:[{label:"Download",fillColor:"rgba(41,128,185,.9)",data:n.upload}]},i={bezierCurve:!1,pointDot:!1,responsive:!0,showTooltips:!1,animation:!1,scaleShowGridLines:!1,scaleLineColor:"rgba(236,240,241,.2)",scaleFontColor:"rgba(236,240,241,1)",datasetStrokeWidth:1,scaleLabel:"<%=value%>Mb",datasetStroke:!1},j=a("#bandwidth-download-chart").get(0).getContext("2d");o=new Chart(j).Line(g,i),j=a("#bandwidth-upload-chart").get(0).getContext("2d"),bandwidthUploadChart=new Chart(j).Line(h,i)}})}function m(e){var f=a("#torrent-template").html();a("#torrents-downloads").prepend(b(f,{id:e.id,name:e.name,progress:100*e.percentDone,status:e.error>0?"error":1===e.percentDone?"complete":"",active:6===e.status?"active":"",info:c(e.totalSize),downloaded:c(e.downloadedEver),uploaded:c(e.uploadedEver),ratio:e.uploadRatio.toFixed(2),files:e.files.length,peers:e.peersConnected+"/"+e["peer-limit"],remain:e.error>0?"unknown":d(e.leftUntilDone)}))}var n={upload:[],download:[],labels:[]},o=bandwidthUploadChart=null;a.ready(e)}(Lea);
//# sourceMappingURL=scripts.min.js.map